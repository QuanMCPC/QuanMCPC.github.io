<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
        <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
        <meta http-equiv="Pragma" content="no-cache" />
        <meta http-equiv="Expires" content="0"/>
        <meta property="og:type" content="website">
        <meta property="og:url" content="https://quanmcpc.github.io">
        <meta property="og:site_name" content="Quan_MCPC's Website">
        <meta property="og:title" content="Quan_MCPC's Website">
        <meta property="og:description" content="My personal website where I practice programming for myself and also post my stuff online.">
        <meta property="og:image" content="https://quanmcpc.github.io/website/image/social_preview_.png">
        <meta property="og:image:alt" content="Social preview image">
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="theme-color" content="#a00000">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secret Forms</title>
    <style>
        form {
            border: 1px solid black;
            width: 350px;
            height: 120px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgb(196, 196, 196);
        }
        #a {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 5px;
        }
        #a p {
            float: right;
        }
    </style>
</head>
<body>
    <form action="./secret.html" method="POST" onsubmit="validate()">
        <div id="a">
            <label for="key">To continue, please enter the Secret ID</label><input name="key" pattern="[a-zA-Z0-9]{5}-[a-zA-Z0-9]{5}-[a-zA-Z0-9]{5}-[a-zA-Z0-9]{5}-[a-zA-Z0-9]{5}" placeholder="Format: 12345-abcde-ABCDE-67890-11111" style="width: 275px; border: 2px solid rgb(0, 0, 0)"><br><br>
            <input type="submit" value="Submit">
            <p>Form By QuanMCPC</p>
        </div>
    </form>
    <script>
        var a = ["5Q4E5R5Q5Q5J5Q4D5R5R5P495O5R5L5R5L4C5L4E5R4E5P4C5L5R5P495R4B"]
        String.prototype.toEncodedString = function () {
            var ostr = this.toString().replace(/\s+/g, '');
            if (ostr.length < 8) {
                console.error("Password must be at least 8 characters long with no spaces.");
                return null;
            };
            var x, nstr = '',
                len = ostr.length;
            for (x = 0; x < len; ++x) {
                nstr += (255 - ostr.charCodeAt(x)).toString(36).toUpperCase().toPaddedString(2, '0');
            };
            return nstr;
        };
        String.prototype.fromEncodedString = function () {
            var ostr = this.toString();
            var x, nstr = '',
                len = ostr.length;
            for (x = 0; x < len; x += 2) {
                nstr += String.fromCharCode(255 - parseInt(ostr.substr(x, 2), 36));
            };
            return nstr;
        };
        Number.prototype.toPaddedString = function (len, pad) {
            len = (len) ? Number(len) : 2;
            if (isNaN(len)) {
                console.error("Padded String 'length' argument is not numeric.");
                return null;
            };
            var dflt = (isNaN(this.toString())) ? " " : "0";
            pad = (pad) ? pad.toString().substr(0, 1) : dflt;
            var str = this.toString();
            if (dflt == "0") {
                while (str.length < len) str = pad + str;
            } else {
                while (str.length < len) str += pad;
            };
            return str;
        };
        String.prototype.toPaddedString = Number.prototype.toPaddedString;
        const cipher = salt => {
            const textToChars = text => text.split('').map(c => c.charCodeAt(0));
            const byteHex = n => ("0" + Number(n).toString(16)).substr(-2);
            const applySaltToChar = code => textToChars(salt).reduce((a,b) => a ^ b, code);
            return text => text.split('')
                .map(textToChars)
                .map(applySaltToChar)
                .map(byteHex)
                .join('');
        }
        function encrypt(plainmessage, key) {
            return cipher(key)(plainmessage).toEncodedString();
        }
        function validate() {
            var key = document.getElementsByName("key")[0].value;
            key = key.replace(/[-]/g, "");
            var plain = key.slice(0, 15);
            var key_ = key.slice(15, 25);
            console.log(plain, key_)
            if (encrypt(plain, key_) == a[0]) {
                alert("Success!")
            } else {
                alert("Fail")
            }
        }
    </script>
</body>
</html>